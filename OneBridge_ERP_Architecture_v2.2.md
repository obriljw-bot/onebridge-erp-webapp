# OneBridge ERP v2.2 (SSR Hybrid) â€” Complete Architecture & Development Standards

## Document Information
- **Version**: 2.2.0
- **Last Updated**: 2025-12-05
- **Status**: Active Development
- **Purpose**: ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ëª…ì„¸ + ê°œë°œ í‘œì¤€ + íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ê°€ì´ë“œ

> âš ï¸ **IMPORTANT**: ì´ ë¬¸ì„œëŠ” OneBridge ERP ê°œë°œì˜ **ì •ê·œ ì°¸ì¡° ë¬¸ì„œ**ì…ë‹ˆë‹¤.
> ëª¨ë“  ì‹ ê·œ ê°œë°œ ë° ìˆ˜ì • ì‘ì—…ì€ ì´ ë¬¸ì„œì˜ í‘œì¤€ì„ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤.

---

# PART 1: SYSTEM ARCHITECTURE

## 1.1 High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Browser (Client)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ SheetJS     â”‚  â”‚ OB.state    â”‚  â”‚ google.script.run       â”‚ â”‚
â”‚  â”‚ (Excel Parse)â”‚  â”‚ (ì „ì—­ìƒíƒœ)   â”‚  â”‚ (Server Communication)  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚              Google Apps Script Server                 â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚                  WebApp.gs                       â”‚  â”‚
                    â”‚  â”‚                  (Entry Point)                   â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚                        â”‚                              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚               UIService.gs                       â”‚  â”‚
                    â”‚  â”‚            (Page Routing/SSR)                    â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚                        â”‚                              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚               ApiService.gs                      â”‚  â”‚
                    â”‚  â”‚         (Client API Endpoints)                   â”‚  â”‚
                    â”‚  â”‚    âš ï¸ ëª¨ë“  ë°˜í™˜ê°’ safeReturn() í•„ìˆ˜              â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚          â”‚                             â”‚              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
                    â”‚  â”‚ DBService.gs  â”‚           â”‚ OrderParsing    â”‚     â”‚
                    â”‚  â”‚ (Data Access) â”‚           â”‚ Service.gs      â”‚     â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
                    â”‚          â”‚                            â”‚              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”      â”‚
                    â”‚  â”‚           InvoiceOutputService.gs          â”‚      â”‚
                    â”‚  â”‚              (PDF Generation)              â”‚      â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                    â”‚                       â”‚                              â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
                    â”‚  â”‚           SettlementService.gs             â”‚      â”‚
                    â”‚  â”‚         (ë§ˆê°/ì²­êµ¬ì„œ ê´€ë¦¬)                   â”‚      â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                            â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                Google Spreadsheets                     â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ ê¸°ì´ˆë°ì´í„°DB  â”‚ â”‚ ë°œì£¼ì…ë ¥DB   â”‚ â”‚ ë°œì£¼í†µí•©DB   â”‚   â”‚
                    â”‚  â”‚ (ê±°ë˜ì²˜,í’ˆëª©) â”‚ â”‚ (ì—…ë¡œë“œì›ë³¸) â”‚ â”‚ (ê±°ë˜ì›ì¥)   â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚ ë§ˆê°DB       â”‚ â”‚ ë§ˆê°ìƒì„¸DB   â”‚ â”‚ ì²­êµ¬DB       â”‚   â”‚
                    â”‚  â”‚ (ë§ˆê° í—¤ë”)  â”‚ â”‚ (ë§ˆê° ìƒì„¸)  â”‚ â”‚ (ì²­êµ¬ì„œ)     â”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Architecture Style**: SSR + SPA Hybrid (HTMLService ê¸°ë°˜ GAS WebApp)

---

## 1.2 File Structure

### Server Files (.gs)
```
â”œâ”€â”€ WebApp.gs                 # ì§„ì…ì  (doGet)
â”œâ”€â”€ UIService.gs              # í˜ì´ì§€ ë¼ìš°íŒ…, SSR í…œí”Œë¦¿
â”œâ”€â”€ ApiService.gs             # í´ë¼ì´ì–¸íŠ¸ API ì—”ë“œí¬ì¸íŠ¸ â­
â”œâ”€â”€ DBService.gs              # ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ ë ˆì´ì–´
â”œâ”€â”€ OrderParsingService.gs    # ë°œì£¼ íŒŒì‹±/ë§¤ì¹­/ì €ì¥ ë¡œì§
â”œâ”€â”€ InvoiceOutputService.gs   # PDF ìƒì„± ì—”ì§„
â””â”€â”€ SettlementService.gs      # ë§ˆê°/ì²­êµ¬ì„œ ê´€ë¦¬ (Phase 2)
```

### Client Files (.html)
```
â”œâ”€â”€ Layout.html               # ë©”ì¸ ë ˆì´ì•„ì›ƒ (SSR í…œí”Œë¦¿)
â”œâ”€â”€ CommonHead.html           # ì „ì—­ CSS
â”œâ”€â”€ CommonScripts.html        # ì „ì—­ JS + í˜ì´ì§€ ì´ˆê¸°í™” í•¨ìˆ˜ â­
â”œâ”€â”€ Component_Sidebar.html    # ë„¤ë¹„ê²Œì´ì…˜ ì‚¬ì´ë“œë°”
â”œâ”€â”€ Component_HeaderNav.html  # ìƒë‹¨ í—¤ë”
â”œâ”€â”€ Page_OrderFile.html       # ë°œì£¼ì…ë ¥ (íŒŒì¼) í˜ì´ì§€
â”œâ”€â”€ Page_OrderList.html       # ë°œì£¼ë‚´ì—­ í˜ì´ì§€
â”œâ”€â”€ Page_Dashboard.html       # ëŒ€ì‹œë³´ë“œ í˜ì´ì§€
â”œâ”€â”€ Page_InvoiceOutput.html   # ì¶œë ¥/ëª…ì„¸ì„œ í˜ì´ì§€
â”œâ”€â”€ Page_PurchaseSettlement.html  # ë§¤ì… ë§ˆê° í˜ì´ì§€ (Phase 2)
â”œâ”€â”€ Page_SalesSettlement.html     # ë§¤ì¶œ ë§ˆê° í˜ì´ì§€ (Phase 2)
â”œâ”€â”€ Page_MonthlyClosing.html      # ì›”ë³„ ë§ˆê° í˜ì´ì§€ (Phase 2)
â”œâ”€â”€ Page_BillingManagement.html   # ì²­êµ¬ì„œ ê´€ë¦¬ í˜ì´ì§€ (Phase 2)
â””â”€â”€ Page_Settings.html        # ì„¤ì • í˜ì´ì§€
```

---

## 1.3 Database Schema

### Spreadsheet IDs
```javascript
const ERP_CONFIG = {
  BASE_DATA_SHEET_ID:    '1vjAjykSQGK2DnFXvmQcH2zuI8WbOvAq_smqvW8u_bao',  // ê¸°ì´ˆë°ì´í„°
  ORDER_INPUT_SHEET_ID:  '11sjwW1NM4fskAQBYnWghbE6d2E0y_EpX-LocgUAevWY',  // ë°œì£¼ì…ë ¥
  ORDER_MERGED_SHEET_ID: '1oz4M6nc_R0vORnV0bl6uPbw_z8EDomo2ko-NF-usyxs'   // ë°œì£¼í†µí•©DB
};
```

### ê±°ë˜ì›ì¥ ì»¬ëŸ¼ êµ¬ì¡°
| ì»¬ëŸ¼ëª… | íƒ€ì… | ì„¤ëª… |
|--------|------|------|
| ë°œì£¼ì¼ | Date | ë°œì£¼ ì¼ì |
| ë°œì£¼ë²ˆí˜¸ | String | `YYYYMMDD-ê±°ë˜ì²˜ì½”ë“œ-ë¸Œëœë“œì½”ë“œ-SEQ` |
| í’ˆëª©ì½”ë“œ | String | ë°”ì½”ë“œ |
| ë¸Œëœë“œ | String | ë¸Œëœë“œëª… |
| ë§¤ì…ì²˜ | String | ê³µê¸‰ì‚¬ëª… |
| ë°œì£¼ì²˜ | String | ê³ ê°ì‚¬ëª… |
| ë¶€ê°€ì„¸êµ¬ë¶„ | String | ë¶€ë³„/ì˜ì„¸/ë©´ì„¸ |
| ì œí’ˆëª… | String | ìƒí’ˆëª… |
| ë°œì£¼ìˆ˜ëŸ‰ | Number | ë°œì£¼ ìˆ˜ëŸ‰ |
| í™•ì •ìˆ˜ëŸ‰ | Number | í™•ì •ëœ ìˆ˜ëŸ‰ |
| ë§¤ì…ê°€ | Number | ë§¤ì… ë‹¨ê°€ |
| ê³µê¸‰ê°€ | Number | ê³µê¸‰ ë‹¨ê°€ |
| ë§¤ì…ì•¡ | Formula | =ë§¤ì…ê°€*ë°œì£¼ìˆ˜ëŸ‰ |
| ê³µê¸‰ì•¡ | Formula | =ê³µê¸‰ê°€*ë°œì£¼ìˆ˜ëŸ‰ |
| ë§ˆì§„ì•¡ | Formula | =ê³µê¸‰ì•¡-ë§¤ì…ì•¡ |
| ë§ˆì§„ìœ¨ | Formula | =ë§ˆì§„ì•¡/ê³µê¸‰ì•¡ |
| ìƒì„±ì¼ì‹œ | String | ISO í˜•ì‹ íƒ€ì„ìŠ¤íƒ¬í”„ |
| ìˆ˜ì •ì¼ì‹œ | String | ISO í˜•ì‹ íƒ€ì„ìŠ¤íƒ¬í”„ |

---

# PART 2: FRONTEND ARCHITECTURE

## 2.1 Layout System

### Layout.html (Root Template)
```html
<!DOCTYPE html>
<html>
  <head>
    <?!= include('CommonHead'); ?>
  </head>
  <body class="ob-body">
    <div class="ob-app-shell">
      <aside class="ob-sidebar">
        <?!= include('Component_Sidebar'); ?>
      </aside>
      <main class="ob-main">
        <header class="ob-header">
          <?!= include('Component_HeaderNav'); ?>
        </header>
        <section id="app-main" class="ob-main-content">
          <!-- SSR: í˜ì´ì§€ ë‚´ìš©ì´ ì—¬ê¸°ì— ì‚½ì…ë¨ -->
        </section>
      </main>
    </div>
    <?!= include('CommonScripts'); ?>
  </body>
</html>
```

---

## 2.2 CommonScripts.html â€” SPA Engine

### í•µì‹¬ ì—­í• 
1. **ì „ì—­ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ê´€ë¦¬** (`window.OB`)
2. **í˜ì´ì§€ ë¼ìš°íŒ…** (SPA ë°©ì‹)
3. **ì„œë²„ í†µì‹  ë˜í¼** (`google.script.run`)
4. **ë¡œë”© ì˜¤ë²„ë ˆì´** ì œì–´
5. **í˜ì´ì§€ë³„ ì´ˆê¸°í™” í•¨ìˆ˜** í˜¸ìŠ¤íŒ…

### í•„ìˆ˜ êµ¬ì¡°
```javascript
// ===== ì „ì—­ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ =====
window.OB = window.OB || {};

// ===== ìƒíƒœ ê´€ë¦¬ =====
OB.state = {
  currentPage: 'orderFile',
  isLoading: false,
  initializedPages: {}
};

// ===== í˜ì´ì§€ ì´ˆê¸°í™” ë””ìŠ¤íŒ¨ì²˜ =====
OB.initCurrentPage = function(page) {
  var initFuncName = 'init' + page.charAt(0).toUpperCase() + page.slice(1) + 'Page';
  if (typeof OB[initFuncName] === 'function') {
    OB[initFuncName]();
  }
};

// ===== ë¡œë”© ì˜¤ë²„ë ˆì´ =====
OB.showLoading = function(message) { /* ... */ };
OB.hideLoading = function() { /* ... */ };

// ===== API ë˜í¼ =====
OB.api = {
  loadPage: function(page) { /* ... */ },
  ping: function() { /* ... */ }
};

// ===== ê° í˜ì´ì§€ë³„ ì´ˆê¸°í™” í•¨ìˆ˜ (â­ ì¤‘ìš”) =====
OB.initOrderFilePage = function() { /* ... */ };
OB.initInvoiceOutputPage = function() { /* ... */ };
// ... ê¸°íƒ€ í˜ì´ì§€
```

---

## 2.3 Page Module Structure

### âš ï¸ í•„ìˆ˜ ê·œì¹™: Page_*.htmlì—ëŠ” JavaScript ì—†ìŒ

```
Page_*.html êµ¬ì¡°:
â”œâ”€â”€ <style> íƒœê·¸ (í˜ì´ì§€ ì „ìš© CSS)
â””â”€â”€ HTML ë§ˆí¬ì—…

âŒ ê¸ˆì§€: <script> íƒœê·¸
âœ… ê¶Œì¥: ëª¨ë“  JavaScriptëŠ” CommonScripts.htmlì— ì •ì˜
```

**ì´ìœ **: SPA ë°©ì‹ì—ì„œ `innerHTML`ë¡œ í˜ì´ì§€ ë¡œë“œ ì‹œ `<script>` íƒœê·¸ê°€ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ

### í˜ì´ì§€ë³„ ìš”ì†Œ ID ê·œì¹™
```
{í˜ì´ì§€ì•½ì–´}-{ìš”ì†Œìœ í˜•}-{ê¸°ëŠ¥}

ì˜ˆì‹œ:
- inv-search-btn      (InvoiceOutputì˜ ì¡°íšŒ ë²„íŠ¼)
- inv-result-tbody    (InvoiceOutputì˜ ê²°ê³¼ í…Œì´ë¸” ë³¸ë¬¸)
- ob-customer-select  (OrderFileì˜ ë°œì£¼ì²˜ ì„ íƒ)
```

---

# PART 3: BACKEND ARCHITECTURE

## 3.1 API Layer Standards â­â­â­

### ğŸš¨ í•µì‹¬ ê·œì¹™: ì§ë ¬í™” í•„ìˆ˜

Google Apps Scriptì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°ì´í„° ë°˜í™˜ ì‹œ, **Date ê°ì²´** ë“± JSONìœ¼ë¡œ ë³€í™˜ ë¶ˆê°€ëŠ¥í•œ ë°ì´í„°ê°€ í¬í•¨ë˜ë©´ **ì „ì²´ ì‘ë‹µì´ null**ë¡œ ë³€í™˜ë©ë‹ˆë‹¤.

### í•„ìˆ˜ í—¬í¼ í•¨ìˆ˜ (ApiService.gs ìƒë‹¨)

```javascript
/**
 * ============================================================
 * í´ë¼ì´ì–¸íŠ¸ ë°˜í™˜ìš© ì§ë ¬í™” í•¨ìˆ˜ (í•„ìˆ˜)
 * ============================================================
 * Date ê°ì²´, undefined ë“±ì„ JSON í˜¸í™˜ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
 * ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œ í•¨ìˆ˜ì—ì„œ ë°˜ë“œì‹œ ì‚¬ìš©í•  ê²ƒ
 */
function safeReturn(data) {
  try {
    return JSON.parse(JSON.stringify(data));
  } catch (e) {
    Logger.log('[safeReturn Error] ' + e.message);
    return {
      success: false,
      error: 'ë°ì´í„° ì§ë ¬í™” ì‹¤íŒ¨: ' + e.message
    };
  }
}

/**
 * í‘œì¤€ ì„±ê³µ ì‘ë‹µ ìƒì„±
 */
function successResponse(data) {
  return safeReturn({
    success: true,
    timestamp: new Date().toISOString(),
    ...data
  });
}

/**
 * í‘œì¤€ ì—ëŸ¬ ì‘ë‹µ ìƒì„±
 */
function errorResponse(message, code) {
  return {
    success: false,
    error: message,
    errorCode: code || 'UNKNOWN_ERROR',
    timestamp: new Date().toISOString()
  };
}
```

---

### í•¨ìˆ˜ ëª…ëª… ê·œì¹™

| ìš©ë„ | íŒ¨í„´ | ì˜ˆì‹œ |
|------|------|------|
| ë‚´ë¶€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ | `ë™ì‚¬ + ëª…ì‚¬` | `getOrderList()`, `processOrder()` |
| í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œìš© | `ë™ì‚¬ + ëª…ì‚¬ + Api` | `getOrderListApi()`, `saveOrderApi()` |
| ë‚´ë¶€ í—¬í¼ í•¨ìˆ˜ | `ë™ì‚¬ + ëª…ì‚¬ + _` | `formatDate_()`, `validateInput_()` |

---

### API í•¨ìˆ˜ í‘œì¤€ íŒ¨í„´

```javascript
/**
 * í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œìš© API í•¨ìˆ˜ í‘œì¤€ íŒ¨í„´
 * @param {Object} params - í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì „ë‹¬ëœ íŒŒë¼ë¯¸í„°
 * @returns {Object} - ì§ë ¬í™”ëœ ì‘ë‹µ ê°ì²´
 */
function someFeatureApi(params) {
  try {
    // 1. ì…ë ¥ ê²€ì¦
    if (!params || !params.requiredField) {
      return errorResponse('í•„ìˆ˜ íŒŒë¼ë¯¸í„°ê°€ ì—†ìŠµë‹ˆë‹¤.', 'INVALID_PARAMS');
    }

    // 2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
    var result = someBusinessLogic(params);

    // 3. ì„±ê³µ ì‘ë‹µ (â­ safeReturn í•„ìˆ˜)
    return safeReturn({
      success: true,
      data: result
    });

  } catch (e) {
    // 4. ì—ëŸ¬ ë¡œê¹… ë° ì‘ë‹µ
    Logger.log('[someFeatureApi Error] ' + e.message + '\n' + e.stack);
    return errorResponse(e.message, 'INTERNAL_ERROR');
  }
}
```

---

## 3.2 ApiService.gs â€” Endpoint Registry

### í˜„ì¬ ë“±ë¡ëœ API í•¨ìˆ˜

| í•¨ìˆ˜ëª… | ìš©ë„ | ì§ë ¬í™” | ìƒíƒœ |
|--------|------|--------|------|
| `ping()` | ì„œë²„ ì—°ê²° í…ŒìŠ¤íŠ¸ | âš ï¸ í•„ìš” | ìˆ˜ì • í•„ìš” |
| `getDashboardStatsApi()` | ëŒ€ì‹œë³´ë“œ í†µê³„ | âœ… í•„ìš” | ì¶”ê°€ í•„ìš” |
| `getOrderListApi()` | ë°œì£¼ ëª©ë¡ ì¡°íšŒ | âœ… í•„ìš” | ì¶”ê°€ í•„ìš” |
| `getOrderDetailApi()` | ë°œì£¼ ìƒì„¸ ì¡°íšŒ | âœ… ì ìš©ë¨ | **ì™„ë£Œ** |
| `getPrintableOrdersApi()` | ì¶œë ¥ìš© ë°œì£¼ ì¡°íšŒ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `generateInvoiceZipApi()` | PDF ZIP ìƒì„± | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `aggregatePurchaseOrdersApi()` | ë§¤ì… ë§ˆê° ì§‘ê³„ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `aggregateSalesOrdersApi()` | ë§¤ì¶œ ë§ˆê° ì§‘ê³„ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `savePurchaseSettlementApi()` | ë§¤ì… ë§ˆê° ì €ì¥ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `saveSalesSettlementApi()` | ë§¤ì¶œ ë§ˆê° ì €ì¥ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `getPurchaseSettlementsApi()` | ë§¤ì… ë§ˆê° ëª©ë¡ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `getSalesSettlementsApi()` | ë§¤ì¶œ ë§ˆê° ëª©ë¡ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `aggregateBillingDataApi()` | ì²­êµ¬ì„œ ì§‘ê³„ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `createBillingApi()` | ì²­êµ¬ì„œ ìƒì„± | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `getBillingsApi()` | ì²­êµ¬ì„œ ëª©ë¡ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `updateBillingStatusApi()` | ì²­êµ¬ì„œ ìƒíƒœ ë³€ê²½ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `executeMonthlyClosingApi()` | ì›”ë³„ ë§ˆê° ì‹¤í–‰ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `unlockMonthlyClosingApi()` | ì›”ë³„ ë§ˆê° í•´ì œ | âœ… ì ìš©ë¨ | ì™„ë£Œ |
| `getMonthlyClosingsApi()` | ì›”ë³„ ë§ˆê° ëª©ë¡ | âœ… ì ìš©ë¨ | ì™„ë£Œ |

---

## 3.3 DBService.gs â€” Data Access Layer

### í•µì‹¬ í•¨ìˆ˜
```javascript
// ì‹œíŠ¸ ì ‘ê·¼
function getSupplierSheet() { }      // ê±°ë˜ì²˜DB
function getProductSheet() { }       // í’ˆëª©DB
function getOrderMergedSheet() { }   // ê±°ë˜ì›ì¥

// ë°ì´í„° ì¡°íšŒ
function getSuppliers() { }          // ê±°ë˜ì²˜ ëª©ë¡
function getProducts() { }           // í’ˆëª© ëª©ë¡
function findProductByBarcode() { }  // ë°”ì½”ë“œ ê²€ìƒ‰

// ë°ì´í„° ì €ì¥
function appendOrderMerged() { }     // ê±°ë˜ì›ì¥ ì¶”ê°€
```

### âš ï¸ í˜¸ì¶œ ê·œì¹™
```javascript
// âŒ ì˜ëª»ëœ í˜¸ì¶œ (DBServiceëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ê°€ ì•„ë‹˜)
DBService.getOrderMergedSheet();

// âœ… ì˜¬ë°”ë¥¸ í˜¸ì¶œ (ì „ì—­ í•¨ìˆ˜)
getOrderMergedSheet();
```

---

## 3.4 OrderParsingService.gs â€” Order Processing Engine

### ë°ì´í„° í”Œë¡œìš°
```
[Browser: SheetJS parse]
        â†“ rows (2D Array)
processParsedOrderRows(rows)
        â†“ { items, matchedCount, unmatchedCount, ... }
saveParsedOrdersToDB(items)
        â†“ { success, savedRows, errors }
Google Sheet (ê±°ë˜ì›ì¥)
```

### ë°œì£¼ë²ˆí˜¸ ìƒì„± ê·œì¹™
```
YYYYMMDD-ê±°ë˜ì²˜ì½”ë“œ-ë¸Œëœë“œì½”ë“œ-SEQ

ì˜ˆì‹œ: 20251127-C001-DR-001
- 20251127: ë°œì£¼ì¼
- C001: ê±°ë˜ì²˜ì½”ë“œ (ë¯¸ë¯¸ë¼ì¸ ëª…ë™ì )
- DR: ë¸Œëœë“œì½”ë“œ (ë‹¥í„°ì§€)
- 001: ì¼ë ¨ë²ˆí˜¸
```

---

# PART 4: DATA FLOW DIAGRAMS

## 4.1 ë°œì£¼ íŒŒì¼ ì—…ë¡œë“œ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User uploads   â”‚
â”‚  Excel file     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SheetJS parse  â”‚  â† Browser (Client-side)
â”‚  â†’ 2D Array     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  processParsedOrderRows(rows)   â”‚  â† Server
â”‚  - í—¤ë” ê°ì§€                      â”‚
â”‚  - í’ˆëª©DB ë§¤ì¹­                    â”‚
â”‚  - matched/unmatched ë¶„ë¥˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display Table  â”‚  â† Browser
â”‚  (ë§¤ì¹­ ê²°ê³¼)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  saveParsedOrdersToDB(items)    â”‚  â† Server
â”‚  - ì‚¬ì „ ê²€ì¦                      â”‚
â”‚  - ë°œì£¼ë²ˆí˜¸ ìƒì„±                   â”‚
â”‚  - ê±°ë˜ì›ì¥ ì €ì¥                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Google Sheet   â”‚
â”‚  (ê±°ë˜ì›ì¥)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4.2 ì¶œë ¥/ëª…ì„¸ì„œ í”Œë¡œìš°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  User: ì¡°íšŒ     â”‚
â”‚  ë²„íŠ¼ í´ë¦­      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  getPrintableOrdersApi(params)  â”‚  â† Server
â”‚  - í•„í„°ë§ (ê¸°ê°„/ë°œì£¼ë²ˆí˜¸/ë§¤ì…ì²˜)   â”‚
â”‚  - ë°œì£¼ë²ˆí˜¸ë³„ ê·¸ë£¹í•‘               â”‚
â”‚  - â­ safeReturn() ì ìš©          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Display Table  â”‚  â† Browser
â”‚  (ë°œì£¼ ëª©ë¡)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  generateInvoiceZipApi(params)  â”‚  â† Server
â”‚  - PDF ìƒì„± (HtmlService)        â”‚
â”‚  - ZIP ì••ì¶• (Utilities.zip)      â”‚
â”‚  - Drive ì €ì¥                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Download ZIP   â”‚  â† Browser
â”‚  (Google Drive) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# PART 5: DEVELOPMENT STANDARDS (í•„ìˆ˜ ì¤€ìˆ˜)

## 5.1 ì„œë²„ í•¨ìˆ˜ ì‘ì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

ìƒˆë¡œìš´ API í•¨ìˆ˜ ì‘ì„± ì‹œ ë°˜ë“œì‹œ í™•ì¸:

- [ ] í•¨ìˆ˜ëª…ì´ `xxxApi` íŒ¨í„´ì„ ë”°ë¥´ëŠ”ê°€?
- [ ] `safeReturn()` ë˜í¼ê°€ ì ìš©ë˜ì—ˆëŠ”ê°€?
- [ ] ë°˜í™˜ ê°ì²´ì— Date ê°ì²´ê°€ ì—†ëŠ”ê°€?
- [ ] try-catchë¡œ ì—ëŸ¬ ì²˜ë¦¬ê°€ ë˜ì–´ìˆëŠ”ê°€?
- [ ] Logger.logë¡œ ë””ë²„ê·¸ ë¡œê·¸ê°€ ìˆëŠ”ê°€?
- [ ] JSDoc ì£¼ì„ì´ ì‘ì„±ë˜ì—ˆëŠ”ê°€?

---

## 5.2 í˜ì´ì§€ ëª¨ë“ˆ ì‘ì„± ì²´í¬ë¦¬ìŠ¤íŠ¸

ìƒˆë¡œìš´ í˜ì´ì§€ ì‘ì„± ì‹œ ë°˜ë“œì‹œ í™•ì¸:

- [ ] Page_Xxx.htmlì—ëŠ” HTML/CSSë§Œ ìˆëŠ”ê°€?
- [ ] `<script>` íƒœê·¸ê°€ ì—†ëŠ”ê°€?
- [ ] `OB.initXxxPage` í•¨ìˆ˜ê°€ CommonScripts.htmlì— ì •ì˜ë˜ì—ˆëŠ”ê°€?
- [ ] ìš”ì†Œ IDê°€ ëª…ëª… ê·œì¹™ì„ ë”°ë¥´ëŠ”ê°€?
- [ ] UIService.gsì— í˜ì´ì§€ ë¼ìš°íŒ…ì´ ì¶”ê°€ë˜ì—ˆëŠ”ê°€?

---

## 5.3 ë°°í¬ ì²´í¬ë¦¬ìŠ¤íŠ¸

ë³€ê²½ ì‚¬í•­ ë°°í¬ ì‹œ ë°˜ë“œì‹œ í™•ì¸:

- [ ] ëª¨ë“  ìˆ˜ì • íŒŒì¼ì´ ì €ì¥ë˜ì—ˆëŠ”ê°€?
- [ ] Apps Script ì—ë””í„°ì—ì„œ **ìƒˆ ë²„ì „**ìœ¼ë¡œ ë°°í¬í–ˆëŠ”ê°€?
- [ ] ë¸Œë¼ìš°ì € ìºì‹œë¥¼ í´ë¦¬ì–´í–ˆëŠ”ê°€? (Ctrl+Shift+R)
- [ ] ì½˜ì†”ì— ì—ëŸ¬ê°€ ì—†ëŠ”ê°€?
- [ ] í•µì‹¬ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ë¥¼ ì™„ë£Œí–ˆëŠ”ê°€?

---

## 5.4 ë””ë²„ê¹… ê°€ì´ë“œ

### ì„œë²„ ì‘ë‹µì´ nullì¼ ë•Œ

```
1. ì„œë²„ í•¨ìˆ˜ ì§ì ‘ ì‹¤í–‰
   â†’ Apps Script ì—ë””í„°ì—ì„œ í•¨ìˆ˜ ì‹¤í–‰ â†’ ë¡œê·¸ í™•ì¸

2. ë°˜í™˜ ë°ì´í„° íƒ€ì… í™•ì¸
   â†’ Logger.log('íƒ€ì…: ' + typeof result);

3. JSON ì§ë ¬í™” í…ŒìŠ¤íŠ¸
   â†’ var json = JSON.stringify(result);
   â†’ Logger.log('JSON ê¸¸ì´: ' + json.length);

4. Date ê°ì²´ í™•ì¸
   â†’ result.someDate instanceof Date â†’ trueë©´ ë¬¸ì œ

5. safeReturn() ì ìš©
   â†’ return safeReturn(result);
```

### í˜ì´ì§€ ì´ˆê¸°í™” í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ë•Œ

```
1. ì½˜ì†”ì—ì„œ í™•ì¸
   â†’ "âš ï¸ ì´ˆê¸°í™” í•¨ìˆ˜ ì—†ìŒ" ë©”ì‹œì§€ í™•ì¸

2. CommonScripts.html í™•ì¸
   â†’ OB.initXxxPage í•¨ìˆ˜ê°€ ì •ì˜ë˜ì–´ ìˆëŠ”ê°€?

3. Page_Xxx.html í™•ì¸
   â†’ <script> íƒœê·¸ê°€ ìˆëŠ”ê°€? â†’ ìˆìœ¼ë©´ ì œê±°

4. í•¨ìˆ˜ëª… ì¼ì¹˜ í™•ì¸
   â†’ page ì´ë¦„ê³¼ init í•¨ìˆ˜ëª…ì´ ì¼ì¹˜í•˜ëŠ”ê°€?
```

---

# PART 6: KNOWN ISSUES & RESOLUTION LOG

## 6.1 í•´ê²°ëœ ì´ìŠˆ

### Issue #001: InvoiceOutput ì¡°íšŒ ë²„íŠ¼ ë¯¸ì‘ë™ (2025-11-27)

**ì¦ìƒ**: ì¡°íšŒ ë²„íŠ¼ í´ë¦­ ì‹œ ì„œë²„ ì‘ë‹µ null

**ì›ì¸**:
1. Page_InvoiceOutput.htmlì˜ `<script>` íƒœê·¸ê°€ SPA ë¡œë“œ ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
2. `getPrintableOrders()` ë°˜í™˜ê°’ì— Date ê°ì²´ í¬í•¨

**í•´ê²°**:
1. ì´ˆê¸°í™” í•¨ìˆ˜ë¥¼ CommonScripts.htmlë¡œ ì´ë™
2. `getPrintableOrdersApi()` ë˜í¼ í•¨ìˆ˜ì— `safeReturn()` ì ìš©

**ì˜í–¥ íŒŒì¼**:
- CommonScripts.html
- Page_InvoiceOutput.html
- ApiService.gs

---

### Issue #002: ë°œì£¼ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ ì˜¤ë¥˜ (2025-12-05) â­ NEW

**ì¦ìƒ**:
- ë°œì£¼ë‚´ì—­ í˜ì´ì§€ì—ì„œ ìƒì„¸ë³´ê¸° í´ë¦­ ì‹œ "ì•Œìˆ˜ì—†ëŠ” ì˜¤ë¥˜" ë©”ì‹œì§€ í‘œì‹œ
- ì½˜ì†” ë° ì‹¤í–‰ì°½ì— ì˜¤ë¥˜ ë©”ì‹œì§€ ì—†ìŒ

**ì›ì¸ ë¶„ì„**:

1. **ì§ì ‘ì  ì›ì¸**: `getOrderDetail()` í•¨ìˆ˜ê°€ `safeReturn()` ë˜í¼ ì—†ì´ ì§ì ‘ í˜¸ì¶œë¨
   ```javascript
   // CommonScripts.html (ìˆ˜ì • ì „)
   google.script.run
     .withSuccessHandler(...)
     .getOrderDetail(orderCode);  // âŒ safeReturn ë¯¸ì ìš©
   ```

2. **ê·¼ë³¸ ì›ì¸**: API í•¨ìˆ˜ ëª…ëª… ê·œì¹™ ë¯¸ì¤€ìˆ˜
   - ë‹¤ë¥¸ API í•¨ìˆ˜ë“¤: `getBillingsApi()`, `getPurchaseSettlementsApi()` ë“± `xxxApi` íŒ¨í„´ ì‚¬ìš©
   - ë¬¸ì œ í•¨ìˆ˜: `getOrderDetail()` - ë‚´ë¶€ ë¡œì§ í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œ

3. **ì™œ "ì•Œìˆ˜ì—†ëŠ” ì˜¤ë¥˜"ê°€ í‘œì‹œë˜ì—ˆë‚˜?**
   - Google Apps Scriptì—ì„œ Date ê°ì²´ê°€ í¬í•¨ëœ ë°ì´í„° ë°˜í™˜ ì‹œ ì§ë ¬í™” ì‹¤íŒ¨
   - ì§ë ¬í™” ì‹¤íŒ¨ ì‹œ í´ë¼ì´ì–¸íŠ¸ì— `null` ë°˜í™˜
   - í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì—ì„œ `result`ê°€ `null`ì¼ ë•Œ "ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜" í‘œì‹œ
   ```javascript
   if (!result || !result.success) {
     alert('ìƒì„¸ ì¡°íšŒ ì‹¤íŒ¨: ' + (result ? result.error : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
   }
   ```

**í•´ê²°**:

1. **ApiService.js** - ë˜í¼ í•¨ìˆ˜ ì¶”ê°€
   ```javascript
   /**
    * ë°œì£¼ ìƒì„¸ ì¡°íšŒ (í´ë¼ì´ì–¸íŠ¸ìš© ë˜í¼)
    */
   function getOrderDetailApi(orderId) {
     var result = getOrderDetail(orderId);
     return safeReturn(result);  // âœ… Date ê°ì²´ ì§ë ¬í™” ì ìš©
   }
   ```

2. **CommonScripts.html** - API í˜¸ì¶œ ë³€ê²½
   ```javascript
   google.script.run
     .withSuccessHandler(...)
     .getOrderDetailApi(orderCode);  // âœ… ë˜í¼ í•¨ìˆ˜ í˜¸ì¶œ
   ```

**ì˜í–¥ íŒŒì¼**:
- ApiService.js (getOrderDetailApi í•¨ìˆ˜ ì¶”ê°€)
- CommonScripts.html (API í˜¸ì¶œ ë³€ê²½)

**êµí›ˆ**:
- ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ í˜¸ì¶œ API í•¨ìˆ˜ëŠ” ë°˜ë“œì‹œ `xxxApi` íŒ¨í„´ì„ ë”°ë¥¼ ê²ƒ
- ê¸°ì¡´ ë‚´ë¶€ ë¡œì§ í•¨ìˆ˜ë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì§ì ‘ í˜¸ì¶œí•˜ì§€ ë§ ê²ƒ
- ìƒˆ API ì¶”ê°€ ì‹œ safeReturn ì ìš© ì—¬ë¶€ ë°˜ë“œì‹œ í™•ì¸

---

## 6.2 ì•Œë ¤ì§„ ì´ìŠˆ (ë¯¸í•´ê²°)

| ID | ì´ìŠˆ | ìš°ì„ ìˆœìœ„ | ìƒíƒœ |
|----|------|----------|------|
| #003 | Page_OrderFile.htmlì— `<script>` íƒœê·¸ ì¡´ì¬ | ë‚®ìŒ | ë³´ë¥˜ (SSRì—ì„œë§Œ ì‚¬ìš©) |
| #004 | getCustomers() í•¨ìˆ˜ ì¤‘ë³µ ì •ì˜ | ì¤‘ê°„ | ê²€í†  í•„ìš” |
| #005 | ping() í•¨ìˆ˜ Date ê°ì²´ ë°˜í™˜ | ë‚®ìŒ | ìˆ˜ì • í•„ìš” |
| #006 | UIService í˜ì´ì§€ëª… ë¶ˆì¼ì¹˜ | ë‚®ìŒ | ìˆ˜ì • ì™„ë£Œ |

---

# PART 7: FUTURE ROADMAP

## 7.1 ë‹¨ê¸° ê³„íš (v2.3)

- [ ] ëª¨ë“  API í•¨ìˆ˜ì— safeReturn() ì ìš© í™•ì¸
- [ ] Page_OrderFile.html ìŠ¤í¬ë¦½íŠ¸ CommonScriptsë¡œ ì´ë™
- [ ] í•¨ìˆ˜ ëª…ëª… ê·œì¹™ í†µì¼
- [ ] ì—ëŸ¬ ì²˜ë¦¬ í‘œì¤€í™”

## 7.2 ì¤‘ê¸° ê³„íš (v3.0)

- [ ] Utils.gs ê³µí†µ ìœ í‹¸ë¦¬í‹° ë¶„ë¦¬
- [ ] ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë„ì…
- [ ] ì½”ë“œ ë¬¸ì„œí™” (JSDoc)
- [ ] Page_Settings ê¸°ëŠ¥ êµ¬í˜„
- [ ] ë§ˆê°/ì²­êµ¬ì„œ ê¸°ëŠ¥ ê³ ë„í™”

## 7.3 ì¥ê¸° ê³„íš

- [ ] Supabase/MySQL ë°ì´í„° ì´ê´€
- [ ] Full SPA ì „í™˜ (React/Vue)
- [ ] í™•ì •ìˆ˜ëŸ‰ íšŒì‹  í¬í„¸
- [ ] ìë™ ë§¤ì…ê²°ì œ ìŠ¤ì¼€ì¤„ë§
- [ ] AI ê¸°ë°˜ ë°œì£¼ ì˜ˆì¸¡

---

# PART 8: APPENDIX

## A. JSON ì§ë ¬í™” ë¶ˆê°€ ë°ì´í„° íƒ€ì…

| íƒ€ì… | í˜„ìƒ | í•´ê²°ì±… |
|------|------|--------|
| Date ê°ì²´ | null ë˜ëŠ” ëˆ„ë½ | `.toISOString()` ë˜ëŠ” `safeReturn()` |
| undefined | í‚¤ ìì²´ê°€ ëˆ„ë½ | nullë¡œ ëª…ì‹œì  ë³€í™˜ |
| í•¨ìˆ˜ | ëˆ„ë½ | ì œê±° |
| ìˆœí™˜ ì°¸ì¡° | ì—ëŸ¬ ë°œìƒ | êµ¬ì¡° ë³€ê²½ |
| NaN | nullë¡œ ë³€í™˜ | ìˆ«ì ê²€ì¦ |
| Infinity | nullë¡œ ë³€í™˜ | ìˆ«ì ê²€ì¦ |

---

## B. í•„ìˆ˜ ì½”ë“œ ìŠ¤ë‹ˆí«

### safeReturn í•¨ìˆ˜
```javascript
function safeReturn(data) {
  try {
    return JSON.parse(JSON.stringify(data));
  } catch (e) {
    Logger.log('[safeReturn Error] ' + e.message);
    return { success: false, error: 'ë°ì´í„° ì§ë ¬í™” ì‹¤íŒ¨' };
  }
}
```

### API í•¨ìˆ˜ í…œí”Œë¦¿
```javascript
/**
 * [ê¸°ëŠ¥ ì„¤ëª…]
 * @param {Object} params - íŒŒë¼ë¯¸í„° ì„¤ëª…
 * @returns {Object} ì‘ë‹µ ê°ì²´
 */
function someFeatureApi(params) {
  try {
    // ì…ë ¥ ê²€ì¦
    if (!params) {
      return { success: false, error: 'íŒŒë¼ë¯¸í„°ê°€ ì—†ìŠµë‹ˆë‹¤.' };
    }

    // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
    var result = someLogic(params);

    // ì„±ê³µ ì‘ë‹µ (ì§ë ¬í™” í•„ìˆ˜)
    return safeReturn({
      success: true,
      data: result
    });

  } catch (e) {
    Logger.log('[someFeatureApi Error] ' + e.message);
    return { success: false, error: e.message };
  }
}
```

### í˜ì´ì§€ ì´ˆê¸°í™” í•¨ìˆ˜ í…œí”Œë¦¿
```javascript
OB.initSomePagePage = function() {
  console.log('ğŸ”§ initSomePagePage ì‹œì‘');

  var mainElement = document.getElementById('some-main-element');
  if (!mainElement) {
    console.error('âŒ ë©”ì¸ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ');
    return;
  }

  // ì¤‘ë³µ ì´ˆê¸°í™” ë°©ì§€
  if (mainElement.dataset.bound === '1') {
    console.log('â­• ì´ë¯¸ ì´ˆê¸°í™”ë¨');
    return;
  }
  mainElement.dataset.bound = '1';

  // ì´ë²¤íŠ¸ ë°”ì¸ë”©
  // ...

  console.log('âœ… initSomePagePage ì™„ë£Œ');
};
```

---

## C. ë³€ê²½ ì´ë ¥

| ë²„ì „ | ë‚ ì§œ | ë³€ê²½ ë‚´ìš© |
|------|------|-----------|
| 2.0.0 | 2025-11 | ì´ˆê¸° ì•„í‚¤í…ì²˜ ë¬¸ì„œ ì‘ì„± |
| 2.1.0 | 2025-11-27 | ì§ë ¬í™” í‘œì¤€, SPA ê·œì¹™, ë””ë²„ê¹… ê°€ì´ë“œ ì¶”ê°€ |
| 2.2.0 | 2025-12-05 | Phase 2 íšŒê³„ ê¸°ëŠ¥ ì¶”ê°€, Issue #002 í•´ê²° (ë°œì£¼ ìƒì„¸ë³´ê¸° ëª¨ë‹¬ ì˜¤ë¥˜), API í•¨ìˆ˜ ëª©ë¡ ì—…ë°ì´íŠ¸ |

---

**Document End**

> ì´ ë¬¸ì„œëŠ” OneBridge ERP í”„ë¡œì íŠ¸ì˜ **ì •ê·œ ì°¸ì¡° ë¬¸ì„œ**ì…ë‹ˆë‹¤.
> ëª¨ë“  ê°œë°œìëŠ” ì´ ë¬¸ì„œì˜ í‘œì¤€ì„ ì¤€ìˆ˜í•´ì•¼ í•©ë‹ˆë‹¤.
> ë¬¸ì„œ ìˆ˜ì • ì‹œ ë°˜ë“œì‹œ ë²„ì „ê³¼ ë³€ê²½ ì´ë ¥ì„ ì—…ë°ì´íŠ¸í•˜ì„¸ìš”.
